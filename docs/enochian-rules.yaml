# Machine-readable specification for Enochian Chess rules.
# This YAML file serves as a single source of truth for game logic.

game_rules:
  board:
    size:
      ranks: 8
      files: 8
    armies:
      count: 4
      names: ["Blue", "Black", "Red", "Yellow"]
    teams:
      count: 2
      definitions:
        Air: ["Blue", "Black"]
        Earth: ["Red", "Yellow"]
    turn_order: ["Blue", "Red", "Black", "Yellow"] # Example for one common array, configurable per array

  pieces:
    king:
      movement: "1 step in any direction (orthogonal or diagonal)"
      capture_behavior: "captured, not checkmated"
    queen:
      movement: "leaps exactly two squares along ranks, files, or diagonals (Alibaba-style), ignoring intervening pieces"
      special_interaction:
        - "cannot capture enemy queens"
        - "can capture enemy bishops whose diagonal system matches the queen's system"
    rook:
      movement: "any number of squares orthogonally"
    bishop:
      movement: "any number of squares diagonally"
      special_interaction:
        - "cannot capture enemy bishops"
        - "can capture enemy queens whose diagonal system matches the bishop's system"
    knight:
      movement: "FIDE knight (2 squares in one direction, 1 square perpendicular)"
    pawn:
      movement: "one square forward only"
      capture: "diagonally forward"
      special_rules:
        - "no double-step initial move"
        - "no en passant"
      promotion:
        standard: "promotes to piece of its 'type' (e.g., pawn of queen becomes queen)"
        privileged:
          condition: "side reduced to (king + queen + pawn) OR (king + bishop + pawn) OR (king + pawn)"
          promotion_targets: ["Queen", "Rook", "Bishop", "Knight"]
          demotion_on_existing: "if promoting to a type already in play, the existing piece is demoted back to a pawn-of-that-type"

  game_mechanics:
    check_logic:
      king_capture_instead_of_mate: true
      must_move_king_in_check:
        condition: "king is in check AND has any legal king move"
        action: "must move the king (even if it stays in check)"
        alternative_action: "if king has no legal move (blocked by friendly pieces, board edge etc.), may move another piece"
    frozen_pieces:
      condition: "when a king is captured"
      effect:
        - "all pieces of that army become frozen"
        - "frozen pieces cannot move"
        - "frozen pieces cannot threaten"
        - "frozen pieces cannot be captured"
        - "frozen pieces occupy squares as blocking terrain"
    throne_seizure:
      condition: "king moves onto an ally’s throne square"
      effect:
        - "gain control of that army"
        - "frozen pieces revive (unfreeze)"
        - "control persists even if king later leaves"
        - "if controlling king is captured, control reverts (if ally still has a king)"
    exchange_of_prisoners:
      condition: "two enemy players each captured a king"
      action: "may agree to exchange kings back to their thrones (or nearest allowed squares) and unfreeze their armies"
    stalemate:
      condition: "player’s unchecked king has no moves except to move into check"
      action: "player skips turns until stalemate is lifted"
    draw_conditions:
      - "both allied kings bare"
      - "four bare kings only"
      - "other conditions as per Zalewski"

  divination_mode:
    enabled: false # Optional, Phase 5
    die_roll_mapping:
      1: ["King", "Pawn"]
      2: "Knight"
      3: "Bishop"
      4: "Queen"
      5: "Rook"
      6: "Pawn"
    rule: "filter legal moves to only moves whose moving piece kind matches the die selection"

  metadata:
    source: "Zalewski-Enochian-Chess-of-the-Golden-Dawn.pdf, Enochian Chess.html"
    version: "1.0"